<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ULTRIX Tipp &amp; Tricks - olf&#x27;s Computer Zoo</title><meta name="robots" content="index, follow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://olfp.github.io/computer-zoo/ultrix-tipp-and-tricks.html"><link rel="amphtml" href="https://olfp.github.io/computer-zoo/amp/ultrix-tipp-and-tricks.html"><link type="application/atom+xml" rel="alternate" href="https://olfp.github.io/computer-zoo/feed.xml"><meta property="og:title" content="ULTRIX Tipp & Tricks"><meta property="og:site_name" content="olf's Computer Zoo"><meta property="og:description" content="StepstonesSince the ULTRIX documentation is a litte sparse, to put it mildly."><meta property="og:url" content="https://olfp.github.io/computer-zoo/ultrix-tipp-and-tricks.html"><meta property="og:type" content="article"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Heebo:400,500|Playfair+Display:400" rel="stylesheet"><link rel="stylesheet" href="https://olfp.github.io/computer-zoo/assets/css/style.css?v=8229f5b0a4397ed7657baf8d8249bb39"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://olfp.github.io/computer-zoo/ultrix-tipp-and-tricks.html"},"headline":"ULTRIX Tipp & Tricks","datePublished":"2018-11-29T20:59","dateModified":"2018-11-29T21:35","description":"StepstonesSince the ULTRIX documentation is a litte sparse, to put it mildly.","author":{"@type":"Person","name":"Olaf Püschel"},"publisher":{"@type":"Organization","name":"Olaf Püschel"}}</script><script async src="https://olfp.github.io/computer-zoo/assets/js/lazysizes.min.js?v=87b142d84db315bc3e1f240a8f92ddc2"></script><style></style></head><body><div class="container"><header class="js-top"><a class="logo" href="https://olfp.github.io/computer-zoo">olf&#x27;s Computer Zoo</a><div class="top"><nav class="navbar js-navbar"><button class="navbar__toggle js-navbar__toggle" aria-expanded="false">Menu</button><ul class="navbar__menu"><li><a href="https://olfp.github.io/computer-zoo/sun-microsystem-3-series.html" target="_self">Sun 3</a></li><li><a href="https://olfp.github.io/computer-zoo/hp-9000.html" target="_self">HP 9000</a></li><li><a href="https://olfp.github.io/computer-zoo/dec-vaxstations.html" target="_self">DEC MicroVAX</a></li><li><a href="https://olfp.github.io/computer-zoo/decstation.html" target="_self">DECstation</a></li><li><a href="https://olfp.github.io/computer-zoo/dec-multia.html" target="_self">DEC Multia</a></li><li><a href="https://olfp.github.io/computer-zoo/apple-mac.html" target="_self">Apple Mac</a></li><li><a href="https://olfp.github.io/computer-zoo/miscellaneous.html" target="_self">Misc</a></li></ul></nav></div></header><main><article class="post u-wrapper"><header class="hero"><h1 class="post__title">ULTRIX Tipp &amp; Tricks</h1></header><div class="post__entry"><div class="para"><h2 class="title">Stepstones</h2><div class="indent"><div class="bbody" align="">Since the ULTRIX documentation is a litte sparse, to put it mildly. So you get stuck much to often.</div></div><div class="para"><h3 class="title"><a name=""></a>I don't want to eat my disk!</h3><div class="indent"><div class="bbody" align="">You should <em>never</em> try to mary a disk with more than one gigabyte with an ULTRIX predating V4.2A. I had the problem with a V4.1 built in 1993 ...<p> </p>The pre V4.2A versions cannot deal with block numbers above 2<span class="exp">21</span>-1. Instead of just not working, it's nasty and wraps around, overwriting the data on the low numbered blocks. Booom.<p> </p>The only solution is to use <em>only</em> the first gigabyte of the disk.</div></div></div><div class="para"><h3 class="title"><a name=""></a>Woah! My disk is too large!</h3><div class="indent"><div class="bbody" align="">All ULTRIX versions can only administer partitions smaller than 2GB. Of course no one prevents you from creating a larger partition, but the following <strong>newfs</strong> fails with an obscure error message.</div></div></div><div class="para"><h3 class="title"><a name=""></a>The new disk won't boot!</h3><div class="indent"><div class="bbody" align="">There are two possibilities. Either it just does not work (happened to me once) or, more probable, it lacks a boot block. In the first case the monitor complains that it cannot find a boot block, in second case abount the boot block having a wrong format.<p> </p>If it just does not work, you can only use another disk. In the other case you typicaly did not create the root file system with <strong>newfs</strong> but with <strong>mkfs</strong>. Only when creating a file system on an a-partition with <strong>newfs</strong> a boot block is written to the disk. Since <strong>newfs</strong> expects to find a disk geometry description in <em>/etc/disktab</em>, you might have to create one.</div></div></div></div><div class="para"><h2 class="title"><a name=""></a>Procedures</h2><div class="indent"> </div><div class="para"><h3 class="title"><a name=""></a>Replacing the system disk with a larger one.</h3><div class="indent"><div class="bbody" align="">Since the typical DECstation disk hold between 200 and 500MB, the wish for more storage is not uncommon. The simplest way is to attach an extra data disk. But when the system disk is an external 5.25" disk (yes, this was sold), wouldn't it be nice to replace that brick with a sweet internal 3.5" disk.<p> </p>To accomplisch that you attach the the new disk in addition to the the old one. When the system disk has e.g. ID1, you can jumper to new disk for ID2. Now power up the system and check if the new disk is recognised in the boot process. Query the disk geometry with <strong>rzdisk</strong>.</div><blockquote><div class="pre">$ rzdisk -g /dev/rrz2a</div></blockquote><div class="bbody" align="">You need the number of cylinders, the tracks per cylinder and the sectors per track. With this you create an entry in <em>/etc/disktab</em>, naming it apropritatly, e.g. "med4g" for a Seagate Medalist 4GB.<p> </p>Next create the partitions with <strong>chpt</strong>. The partition is selected with the <em>-p</em> option. Arguments are the starting block, the number of blocks and the device name of the a- or c-partition.</div><blockquote><div class="pre">$ chpt -pd 2354365 4364574 /dev/rrz2c</div></blockquote><div class="bbody" align="">Defines a d-partition starting at 2354365 with 4364574 blocks on the disk with ID2. Now create file systems for all partitions (except b and c, which are swap and overlap). For this <strong>newfs</strong> uses the partizioning information from <em>/etc/disktab</em>.</div><blockquote><div class="pre">$ newfs /dev/rz2d med4g</div></blockquote><div class="bbody" align="">Creates a file system on the g-partition according the data in <em>/etc/disktab</em>. Unlike many other systems ULTRIX has no command to explicitly write the boot block. Instead the boot block is written automagically each time you create an a-partition with <strong>newfs</strong>.<p> </p>Now the partitions are mounted on after the other and the data is coopied from the old disk to the new one.</div><blockquote><div class="pre">$ mount /dev/rz2d /mnt $ cd /mnt $ dump 0f - /usr | restore rf -</div></blockquote><div class="bbody" align="">Mounts the d-partition and copies the data in the <em>/usr</em> partition of the old disk. Its important to change the directory because <strong>restore</strong> unpacks all data into the current working directory.<p> </p>Finally the DECstation is schut down and the old disk removed. Now you jumper the new disk to have the same ID as the old one, and the system should boot of the new disk.</div></div></div></div></div><footer class="post__footer"><div class="post__footer__col"><ul class="post__tag"><li><a href="https://olfp.github.io/computer-zoo/dec/">dec</a></li><li><a href="https://olfp.github.io/computer-zoo/misc/">misc</a></li></ul></div><div class="post__related"><h3 class="u-h5">Related posts</h3><div class="post__related__wrap"><figure><a href="https://olfp.github.io/computer-zoo/dec-vaxstations.html"><img class="lazyload" src="https://olfp.github.io/computer-zoo/media/posts/2/responsive/vax-term-detail-xs.jpeg" data-srcset="https://olfp.github.io/computer-zoo/media/posts/2/responsive/vax-term-detail-xs.jpeg" data-expand="300" alt=""></a><figcaption><h4><a href="https://olfp.github.io/computer-zoo/dec-vaxstations.html" class="inverse">DEC MicroVAX</a></h4><time datetime="2018-11-29T20:39">November 29, 2018</time></figcaption></figure><figure><a href="https://olfp.github.io/computer-zoo/decstation.html"><img class="lazyload" src="https://olfp.github.io/computer-zoo/media/posts/3/responsive/decstation-detail-xs.jpeg" data-srcset="https://olfp.github.io/computer-zoo/media/posts/3/responsive/decstation-detail-xs.jpeg" data-expand="300" alt=""></a><figcaption><h4><a href="https://olfp.github.io/computer-zoo/decstation.html" class="inverse">DECstation 5000</a></h4><time datetime="2018-11-29T20:47">November 29, 2018</time></figcaption></figure><figure><a href="https://olfp.github.io/computer-zoo/dec-multia.html"><img class="lazyload" src="https://olfp.github.io/computer-zoo/media/posts/5/responsive/multia-detail-xs.jpeg" data-srcset="https://olfp.github.io/computer-zoo/media/posts/5/responsive/multia-detail-xs.jpeg" data-expand="300" alt=""></a><figcaption><h4><a href="https://olfp.github.io/computer-zoo/dec-multia.html" class="inverse">DEC Multia VX40</a></h4><time datetime="2018-11-29T21:12">November 29, 2018</time></figcaption></figure></div></div></footer></article></main><footer class="footer"><div class="footer__copyright">Powered by Publii. Comments, questions, visitation requests and contributions to: Olaf Püschel</div></footer></div><script defer="defer" src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script><script defer="defer" src="https://olfp.github.io/computer-zoo/assets/js/scripts.min.js?v=f503b0ac46db9f99180b3b9f932c7f9a"></script></body></html>